<!-- omit in toc -->
# VM Configuration for Malware Analysis

<!-- omit in toc -->
## Table of Contents

1. [General](#general)
2. [Function](#function)
3. [Configuration](#configuration)
   1. [VirtualBox](#virtualbox)
   2. [REMnux](#remnux)
      1. [Inetsim](#inetsim)
         1. [Features](#features)
         2. [Configuration](#configuration-1)
   3. [FlareVM](#flarevm)
      1. [Network Configuration](#network-configuration)

## General

- Create 2 VMs:
  - FlareVM.
    - All default.
  - REMnux.
    - All default.

## Function

- FlareVM:
  - Host Based Indicators.
- REMnux:
  - Network Based Indicators.

## Configuration

### VirtualBox

- Network adapters:
  - Tools > Network > Create
  - Adapter > IPv4 Address > 10.0.0.1
  - Adapter > IPv4 Network Mask > 255.255.255.0
  - DHCP Server > Enable Server
  - DHCP Server > Server Address > 10.0.0.2
  - DHCP Server > Server Mask > 255.255.255.0
  - DHCP Server > Local Address Bound > 10.0.0.3
  - DHCP Server > Upper Address Bound > 10.0.0.254

- VM Settings:
  - Network > Attached to > Host-only adapter > [Just created adapter].
  - Check that any other adapter is not enabled.

- FlareVM:
  - `ipconfig` (Adapter has to be in the 10.0.0.1 network).
  - `ping 8.8.8.8` (Has to fail).

- REMnux:
  - `ip a` (Adapter has to be in the 10.0.0.1 network).
  - `ping 8.8.8.8` (Has to fail).

### REMnux

#### Inetsim

##### Features

- If you access to the IP address of the REMnux machine, you will see a default `inetsim` page.
- If a malware accesses a resource like an `.exe` it downloads a generic `.exe` that has a message box (Not malicious).

##### Configuration

- Edit `/etc/inetsim/inetsim.conf` file.
  - Enable DNS service.
  - `service_bind_address 0.0.0.0`.
  - `dns_default_ip {eth0 IP Address}`.
- `inetsim` (To start the service).

### FlareVM

#### Network Configuration

- Control Panel > Network and Internet > Network Connections > Right Click Ethernet Adapter > Properties > Internet Protocol Version 4 > Use the following DNS server addresses > Preferred DNS server > [REMnux IP Address].
